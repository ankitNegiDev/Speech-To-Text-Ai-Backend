<!DOCTYPE html>
<html>
    <head>
        <title>Audio Transcription</title>
    </head>
    <body>
        <h2>Upload Audio File</h2>
        <input type="file" id="audioFile" accept="audio/*" />
        <button onclick="uploadAudio()">Upload</button>

        <div id="loader" style="display: none">Loading...</div>
        <div id="result"></div>

        <script>
            async function uploadAudio() {
                const fileInput = document.getElementById("audioFile");
                const file = fileInput.files[0];

                if (!file) {
                    alert("Please select an audio file.");
                    return;
                }

                const formData = new FormData();
                formData.append("audio", file);

                document.getElementById("loader").style.display = "block";
                document.getElementById("result").innerText = "";

                try {
                    const response = await fetch(
                        "http://localhost:3000/api/audio/upload",
                        {
                            method: "POST",
                            body: formData,
                        }
                    );

                    const data = await response.json();
                    document.getElementById("loader").style.display = "none";

                    if (data.success) {
                        document.getElementById(
                            "result"
                        ).innerText = `Transcription: ${data.transcription.text}`;
                    } else {
                        document.getElementById("result").innerText = `Error: ${
                            data.error || "Something went wrong"
                        }`;
                    }
                } catch (err) {
                    console.error(err);
                    document.getElementById("loader").style.display = "none";
                    document.getElementById("result").innerText =
                        "An error occurred while uploading.";
                }
            }
        </script>
    </body>
</html>
